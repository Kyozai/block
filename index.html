<!DOCTYPE html>
<html>
<head>
    <title>Block Kyozai</title>
    <!-- BlocklyライブラリのCDNを読み込む -->
    <script src="https://unpkg.com/blockly"></script>
</head>
<body>
    <!-- ブロックの作業領域を表示するための要素 -->
    <div id="blocklyDiv" style="height: 400px; width: 600px;"></div>

    <!-- ツールボックスを定義 -->
    <xml id="toolbox" style="display: none;">
        <block type="controls_if"></block>
        <block type="logic_compare"></block>
        <!-- 他のブロックを追加 -->
        <!-- カスタムブロックを定義 -->
        <block type="custom_addition"></block>
      
    </xml>

    <!-- Blocklyの初期化 -->
    <script>
        // Blocklyの初期化
        var workspace = Blockly.inject('blocklyDiv', {
            toolbox: document.getElementById('toolbox')  // ツールボックスの要素を指定
        });

// カスタムブロックの定義
        Blockly.Blocks['custom_addition'] = {
            init: function() {
                this.jsonInit({
                    "type": "custom_addition",
                    "message0": "%1 + %2",
                    "args0": [
                        {
                            "type": "input_value",
                            "name": "A",
                            "check": "Number"  // 入力の型を指定
                        },
                        {
                            "type": "input_value",
                            "name": "B",
                            "check": "Number"  // 入力の型を指定
                        }
                    ],
                    "output": "Number",
                    "colour": 230,
                    "tooltip": "Add two numbers"
                });
            }
        };

        // カスタムブロックのJavaScript生成
        Blockly.JavaScript['custom_addition'] = function(block) {
            var value_a = Blockly.JavaScript.valueToCode(block, 'A', Blockly.JavaScript.ORDER_NONE);
            var value_b = Blockly.JavaScript.valueToCode(block, 'B', Blockly.JavaScript.ORDER_NONE);
            var code = value_a + ' + ' + value_b;
            return [code, Blockly.JavaScript.ORDER_ADDITION];
        };



        
        // ブロックが変更された際のコールバックを設定
        workspace.addChangeListener(updateCode);

        // 生成されたコードを表示するためのエリア
        var codeArea = document.getElementById('codeArea');

        // 生成されたコードを更新するコールバック関数
        function updateCode(event) {
            var code = Blockly.JavaScript.workspaceToCode(workspace);
            codeArea.textContent = code;
        }
    </script>

    <!-- 生成されたコードを表示するためのエリア -->
    <pre id="codeArea"></pre>
</body>

</html>

